var Ne=Object.defineProperty,_e=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var Q=(r,l,u)=>l in r?Ne(r,l,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[l]=u,q=(r,l)=>{for(var u in l||(l={}))xe.call(l,u)&&Q(r,u,l[u]);if(Z)for(var u of Z(l))we.call(l,u)&&Q(r,u,l[u]);return r},X=(r,l)=>_e(r,ye(l));import{bi as _,bs as S,ax as Ee,aB as w,ec as U,aC as ie,bB as ke,aP as Ie,ai as Te,n as ue,ap as Fe,ah as Se,d as oe,e as de,aR as he,v as E,au as P,aU as Ae,e1 as Ce,aE as Pe,z as me,cc as Be,C as L,o as y,W as ee,O as te,h as p,i as n,F as B,V as G,ao as $,w as V,g as F,aZ as $e,ed as Ue,am as ae,bJ as Me,cd as De,U as Ke,G as W,j as ze,bY as Oe,bK as Re,aV as ne,ee as qe,aM as Le,_ as Ge,A as le,K as We,k as x,l as Ye,m as re,$ as je}from"./index-DXV2JZ8m.js";import{a as He,E as Je}from"./el-form-item-B5fc7SOt.js";/* empty css                  */import{v as se}from"./index-DhzvRtaC.js";import"./_Uint8Array-Bj4etxqr.js";import"./_initCloneObject-Dex4nZC8.js";const Ze=Ee(q({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:Ie,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:r=>r===null||_(r)||["min","max"].includes(r),default:null},name:String,placeholder:String,precision:{type:Number,validator:r=>r>=0&&r===Number.parseInt(`${r}`,10)},validateEvent:{type:Boolean,default:!0}},ke(["ariaLabel"]))),Qe={[ie]:(r,l)=>l!==r,blur:r=>r instanceof FocusEvent,focus:r=>r instanceof FocusEvent,[U]:r=>_(r)||S(r),[w]:r=>_(r)||S(r)},Xe=ue({name:"ElInputNumber"}),et=ue(X(q({},Xe),{props:Ze,emits:Qe,setup(r,{expose:l,emit:u}){const i=r,{t:k}=Fe(),g=Se("input-number"),o=oe(),t=de({currentValue:i.modelValue,userInput:null}),{formItem:f}=he(),v=E(()=>_(i.modelValue)&&i.modelValue<=i.min),I=E(()=>_(i.modelValue)&&i.modelValue>=i.max),M=E(()=>{const e=j(i.step);return P(i.precision)?Math.max(j(i.modelValue),e):(e>i.precision,i.precision)}),c=E(()=>i.controls&&i.controlsPosition==="right"),Y=Ae(),T=Ce(),D=E(()=>{if(t.userInput!==null)return t.userInput;let e=t.currentValue;if(S(e))return"";if(_(e)){if(Number.isNaN(e))return"";P(i.precision)||(e=e.toFixed(i.precision))}return e}),K=(e,a)=>{if(P(a)&&(a=M.value),a===0)return Math.round(e);let s=String(e);const d=s.indexOf(".");if(d===-1||!s.replace(".","").split("")[d+a])return e;const A=s.length;return s.charAt(A-1)==="5"&&(s=`${s.slice(0,Math.max(0,A-1))}6`),Number.parseFloat(Number(s).toFixed(a))},j=e=>{if(S(e))return 0;const a=e.toString(),s=a.indexOf(".");let d=0;return s!==-1&&(d=a.length-s-1),d},H=(e,a=1)=>_(e)?K(e+i.step*a):t.currentValue,z=()=>{if(i.readonly||T.value||I.value)return;const e=Number(D.value)||0,a=H(e);h(a),u(U,t.currentValue),R()},O=()=>{if(i.readonly||T.value||v.value)return;const e=Number(D.value)||0,a=H(e,-1);h(a),u(U,t.currentValue),R()},J=(e,a)=>{const{max:s,min:d,step:m,precision:N,stepStrictly:A,valueOnClear:C}=i;s<d&&Oe("InputNumber","min should not be greater than max.");let b=Number(e);if(S(e)||Number.isNaN(b))return null;if(e===""){if(C===null)return null;b=Re(C)?{min:d,max:s}[C]:C}return A&&(b=K(Math.round(b/m)*m,N),b!==e&&a&&u(w,b)),P(N)||(b=K(b,N)),(b>s||b<d)&&(b=b>s?s:d,a&&u(w,b)),b},h=(e,a=!0)=>{var s;const d=t.currentValue,m=J(e);if(!a){u(w,m);return}d===m&&e||(t.userInput=null,u(w,m),d!==m&&u(ie,m,d),i.validateEvent&&((s=f==null?void 0:f.validate)==null||s.call(f,"change").catch(N=>ne())),t.currentValue=m)},pe=e=>{t.userInput=e;const a=e===""?null:Number(e);u(U,a),h(a,!1)},ce=e=>{const a=e!==""?Number(e):"";(_(a)&&!Number.isNaN(a)||e==="")&&h(a),R(),t.userInput=null},fe=()=>{var e,a;(a=(e=o.value)==null?void 0:e.focus)==null||a.call(e)},be=()=>{var e,a;(a=(e=o.value)==null?void 0:e.blur)==null||a.call(e)},ve=e=>{u("focus",e)},Ve=e=>{var a,s;t.userInput=null,qe()&&t.currentValue===null&&((a=o.value)!=null&&a.input)&&(o.value.input.value=""),u("blur",e),i.validateEvent&&((s=f==null?void 0:f.validate)==null||s.call(f,"blur").catch(d=>ne()))},R=()=>{t.currentValue!==i.modelValue&&(t.currentValue=i.modelValue)},ge=e=>{document.activeElement===e.target&&e.preventDefault()};return Pe(()=>i.modelValue,(e,a)=>{const s=J(e,!0);t.userInput===null&&s!==a&&(t.currentValue=s)},{immediate:!0}),me(()=>{var e;const{min:a,max:s,modelValue:d}=i,m=(e=o.value)==null?void 0:e.input;if(m.setAttribute("role","spinbutton"),Number.isFinite(s)?m.setAttribute("aria-valuemax",String(s)):m.removeAttribute("aria-valuemax"),Number.isFinite(a)?m.setAttribute("aria-valuemin",String(a)):m.removeAttribute("aria-valuemin"),m.setAttribute("aria-valuenow",t.currentValue||t.currentValue===0?String(t.currentValue):""),m.setAttribute("aria-disabled",String(T.value)),!_(d)&&d!=null){let N=Number(d);Number.isNaN(N)&&(N=null),u(w,N)}m.addEventListener("wheel",ge,{passive:!1})}),Be(()=>{var e,a;const s=(e=o.value)==null?void 0:e.input;s==null||s.setAttribute("aria-valuenow",`${(a=t.currentValue)!=null?a:""}`)}),l({focus:fe,blur:be}),(e,a)=>(y(),L("div",{class:G([n(g).b(),n(g).m(n(Y)),n(g).is("disabled",n(T)),n(g).is("without-controls",!e.controls),n(g).is("controls-right",n(c))]),onDragstart:W(()=>{},["prevent"])},[e.controls?ee((y(),L("span",{key:0,role:"button","aria-label":n(k)("el.inputNumber.decrease"),class:G([n(g).e("decrease"),n(g).is("disabled",n(v))]),onKeydown:B(O,["enter"])},[$(e.$slots,"decrease-icon",{},()=>[p(n(ae),null,{default:V(()=>[n(c)?(y(),F(n($e),{key:0})):(y(),F(n(Ue),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[n(se),O]]):te("v-if",!0),e.controls?ee((y(),L("span",{key:1,role:"button","aria-label":n(k)("el.inputNumber.increase"),class:G([n(g).e("increase"),n(g).is("disabled",n(I))]),onKeydown:B(z,["enter"])},[$(e.$slots,"increase-icon",{},()=>[p(n(ae),null,{default:V(()=>[n(c)?(y(),F(n(Me),{key:0})):(y(),F(n(De),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[n(se),z]]):te("v-if",!0),p(n(ze),{id:e.id,ref_key:"input",ref:o,type:"number",step:e.step,"model-value":n(D),placeholder:e.placeholder,readonly:e.readonly,disabled:n(T),size:n(Y),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,onKeydown:[B(W(z,["prevent"]),["up"]),B(W(O,["prevent"]),["down"])],onBlur:Ve,onFocus:ve,onInput:pe,onChange:ce},Ke({_:2},[e.$slots.prefix?{name:"prefix",fn:V(()=>[$(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:V(()=>[$(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}}));var tt=Te(et,[["__file","input-number.vue"]]);const at=Le(tt),nt={class:"flex-btn"},lt={__name:"SafetyConfig",setup(r){const l=de({lockTime:20,maxFailNum:5,loginTimeout:30,passwdValidity:90,tokenExpireTime:10080}),u=E(()=>({lockTime:[{required:!0,trigger:"blur",message:"请输入正整数值"}],maxFailNum:[{required:!0,trigger:"blur",message:"请输入正整数值"}],loginTimeout:[{required:!0,trigger:"blur",message:"请输入正整数值"}],passwdValidity:[{required:!0,trigger:"blur",message:"请输入正整数值"}],tokenExpireTime:[{required:!0,trigger:"blur",message:"请输入正整数值"}]}));me(()=>{g()});const i=oe(null),k=o=>{switch(o){case"save":{i.value.validate(t=>{if(t){const f={max_fail_num:l.maxFailNum,login_timeout:l.loginTimeout,locked_time_length:l.lockTime,password_period:l.passwdValidity,token_expires_time:l.tokenExpireTime*60};le.postUserApi("service_config",f).then(v=>{v!=null&&v.success&&je({type:"success",message:"安全配置保存成功, 再次登录时生效！"})})}else return});break}case"reset":{i.value.resetFields(),g();break}}},g=()=>{le.getUserApi("service_config").then(o=>{o!=null&&o.data&&(l.maxFailNum=o.data.max_fail_num,l.loginTimeout=o.data.login_timeout,l.lockTime=o.data.locked_time_length,l.passwdValidity=o.data.password_period,l.tokenExpireTime=We.round(o.data.token_expires_time/60))})};return(o,t)=>{const f=at,v=He,I=Ye,M=Je;return y(),F(M,{ref_key:"safeFormRef",ref:i,class:"safety-form sy-form pl-30px","label-position":"top",model:n(l),rules:n(u)},{default:V(()=>[p(v,{label:"密码有效期",prop:"passwdValidity"},{default:V(()=>[p(f,{modelValue:n(l).passwdValidity,"onUpdate:modelValue":t[0]||(t[0]=c=>n(l).passwdValidity=c),max:90,min:1,step:1,"step-strictly":!0},null,8,["modelValue"]),t[7]||(t[7]=x("span",{class:"unit"},"天",-1))]),_:1,__:[7]}),p(v,{label:"密码锁定时间",prop:"lockTime"},{default:V(()=>[p(f,{modelValue:n(l).lockTime,"onUpdate:modelValue":t[1]||(t[1]=c=>n(l).lockTime=c),max:120,min:20,step:10,"step-strictly":!0},null,8,["modelValue"]),t[8]||(t[8]=x("span",{class:"unit"},"分钟",-1))]),_:1,__:[8]}),p(v,{label:"密码失败次数",prop:"maxFailNum"},{default:V(()=>[p(f,{modelValue:n(l).maxFailNum,"onUpdate:modelValue":t[2]||(t[2]=c=>n(l).maxFailNum=c),max:10,min:1,step:1,"step-strictly":!0},null,8,["modelValue"]),t[9]||(t[9]=x("span",{class:"unit"},"次",-1))]),_:1,__:[9]}),p(v,{label:"自动注销时间",prop:"loginTimeout"},{default:V(()=>[p(f,{modelValue:n(l).loginTimeout,"onUpdate:modelValue":t[3]||(t[3]=c=>n(l).loginTimeout=c),max:2880,min:10,step:5,"step-strictly":!0},null,8,["modelValue"]),t[10]||(t[10]=x("span",{class:"unit"},"分钟",-1))]),_:1,__:[10]}),p(v,{label:"系统会话时间",prop:"tokenExpireTime"},{default:V(()=>[p(f,{modelValue:n(l).tokenExpireTime,"onUpdate:modelValue":t[4]||(t[4]=c=>n(l).tokenExpireTime=c),modelModifiers:{number:!0},max:2880,min:1,step:1,"step-strictly":!0},null,8,["modelValue"]),t[11]||(t[11]=x("span",{class:"unit"},"分钟",-1))]),_:1,__:[11]}),p(v,null,{default:V(()=>[x("div",nt,[p(I,{class:"sy-btn-default",type:"warning",onClick:t[5]||(t[5]=c=>k("reset"))},{default:V(()=>t[12]||(t[12]=[re("重置 ")])),_:1,__:[12]}),p(I,{class:"sy-btn-default",type:"primary",onClick:t[6]||(t[6]=c=>k("save"))},{default:V(()=>t[13]||(t[13]=[re("保存 ")])),_:1,__:[13]})])]),_:1})]),_:1},8,["model","rules"])}}},pt=Ge(lt,[["__scopeId","data-v-9e746803"]]);export{pt as default};
