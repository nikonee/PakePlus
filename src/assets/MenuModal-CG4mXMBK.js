var H=Object.defineProperty,J=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var O=(u,s,t)=>s in u?H(u,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[s]=t,w=(u,s)=>{for(var t in s||(s={}))h.call(s,t)&&O(u,t,s[t]);if(A)for(var t of A(s))z.call(s,t)&&O(u,t,s[t]);return u},B=(u,s)=>J(u,L(s));var v=(u,s,t)=>new Promise((c,y)=>{var V=l=>{try{_(t.next(l))}catch(d){y(d)}},f=l=>{try{_(t.throw(l))}catch(d){y(d)}},_=l=>l.done?c(l.value):Promise.resolve(l.value).then(V,f);_((t=t.apply(u,s)).next())});import{_ as G,a2 as K,u as Q,d as U,aE as W,v as C,aa as X,e as Y,g as F,o as x,w as m,k as Z,h as n,i as r,j as ee,C as le,J as te,P as ae,l as oe,m as q,H as re,A as k,$ as E}from"./index-CTBb4ZkS.js";import{E as ne}from"./el-overlay-D3Gjxykq.js";/* empty css                  */import{E as se,a as ue}from"./el-form-item-CfUEk-Ki.js";import{E as ie}from"./el-switch-By721Gye.js";import"./el-table-column-DGusqlFC.js";import{E as me,a as de}from"./el-select-BK9AHEpf.js";import"./index-NZlxnoz3.js";import"./_Uint8Array-DrW7drqq.js";import"./_initCloneObject-BGH32tGU.js";import"./el-checkbox-D8hjxyAE.js";import"./token-DI9FKtlJ.js";import"./strings-BlQ6dbze.js";const pe={class:"menu-modal"},ce={__name:"MenuModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"菜单编辑"},data:{type:Object,default:()=>{}}},emits:["close","confirm"],setup(u,{emit:s}){const t=s,c=u,y=K(),V=Q(),f=U(!1);W(()=>c.visible,p=>{f.value=p});const _=C(()=>X.MenuTypes),l=Y({app_code:y.appCode,parent_id:"",parentTitle:"",parent_title:"",title:"",menu_type:"",uri:"",order_num:"",enable:"",creator_id:"",creator_name:"",name:"",param:""}),d=U(null),R=C(()=>({parent_title:[{required:!0,message:"请输入上级组织",trigger:"blur"}],title:[{required:!0,message:"请输入组织名",trigger:"blur"}],menu_type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],uri:[{required:!0,message:"请输入路由地址",trigger:"blur"}],order_num:[{required:!0,validator:(e,i,o)=>{i===""?o(new Error("请输入排序号")):/^(0|[1-9][0-9]*)$/.test(l.order_num)?o():o(new Error("请输入大于0的自然数"))},trigger:"blur"}],name:[{required:!0,message:"请输入路由名称",trigger:"blur"}]})),M=U([]),D=()=>v(this,null,function*(){yield N(),Object.assign(l,w({},c.data)),d.value&&d.value.clearValidate()}),I=()=>{d.value&&d.value.resetFields(),t("close")},S=p=>{switch(p){case"confirm":d.value.validate(e=>v(this,null,function*(){if(e){const i=B(w({},l),{parentTitle:void 0});if(c.title==="新增菜单"){i.code=void 0;const o=V.userId,g=V.username;o&&g&&(i.creator_id=o,i.creator_name=g),k.postUserApi("menu/create",i).then(b=>{b!=null&&b.success?(E({type:"success",message:c.title+"成功！"}),t("confirm"),t("close")):E({type:"error",message:c.title+"失败！"})})}else k.postUserApi("menu/update",i).then(o=>{o!=null&&o.success?(E({type:"success",message:"修改成功！"}),t("confirm"),t("close")):E({type:"error",message:"修改失败！"})})}}));break;case"cancel":t("close");break}},N=()=>v(this,null,function*(){yield k.getBaseApi("acsubsystem").then(p=>{p.success?M.value=p.data.map(e=>({label:e.name,value:e.code})):M.value=[]})});return(p,e)=>{const i=ee,o=ue,g=de,b=me,$=ie,j=se,T=oe,P=ne;return x(),F(P,{modelValue:r(f),"onUpdate:modelValue":e[9]||(e[9]=a=>re(f)?f.value=a:null),class:"sy-dialog sy-dialog--mini",title:u.title,width:"30vw","close-on-click-modal":!1,"append-to-body":"",center:"",onOpen:D,onClose:I},{footer:m(()=>[n(T,{class:"sy-btn-default",type:"warning",onClick:e[7]||(e[7]=a=>S("cancel"))},{default:m(()=>e[10]||(e[10]=[q("取消")])),_:1,__:[10]}),n(T,{class:"sy-btn-default",type:"primary",onClick:e[8]||(e[8]=a=>S("confirm"))},{default:m(()=>e[11]||(e[11]=[q("确定")])),_:1,__:[11]})]),default:m(()=>[Z("div",pe,[n(j,{ref_key:"menuFormRef",ref:d,class:"sy-form menu-modal-form","label-suffix":"：","label-width":"auto",model:r(l),rules:r(R)},{default:m(()=>[n(o,{label:"上级菜单",prop:"parentTitle"},{default:m(()=>[n(i,{modelValue:r(l).parentTitle,"onUpdate:modelValue":e[0]||(e[0]=a=>r(l).parentTitle=a),placeholder:"请输入上级菜单名称",maxlength:50,disabled:""},null,8,["modelValue"])]),_:1}),n(o,{label:"菜单名称",prop:"title"},{default:m(()=>[n(i,{modelValue:r(l).title,"onUpdate:modelValue":e[1]||(e[1]=a=>r(l).title=a),placeholder:"请输入菜单名称",maxlength:50},null,8,["modelValue"])]),_:1}),n(o,{label:"菜单类型",prop:"menu_type"},{default:m(()=>[n(b,{modelValue:r(l).menu_type,"onUpdate:modelValue":e[2]||(e[2]=a=>r(l).menu_type=a),"popper-class":"sy-popper",placeholder:"请选择菜单类型",clearable:""},{default:m(()=>[(x(!0),le(te,null,ae(r(_),a=>(x(),F(g,{key:a.key,label:a.value,value:a.key+""},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(o,{label:"路由名称",prop:"name"},{default:m(()=>[n(i,{modelValue:r(l).name,"onUpdate:modelValue":e[3]||(e[3]=a=>r(l).name=a),modelModifiers:{trim:!0},placeholder:"请输入路由名称",maxlength:50},null,8,["modelValue"])]),_:1}),n(o,{label:"路由地址",prop:"uri"},{default:m(()=>[n(i,{modelValue:r(l).uri,"onUpdate:modelValue":e[4]||(e[4]=a=>r(l).uri=a),modelModifiers:{trim:!0},placeholder:"请输入路由地址",maxlength:50},null,8,["modelValue"])]),_:1}),n(o,{label:"排序号",prop:"order_num"},{default:m(()=>[n(i,{modelValue:r(l).order_num,"onUpdate:modelValue":e[5]||(e[5]=a=>r(l).order_num=a),modelModifiers:{number:!0},placeholder:"请输入排序号",min:0},null,8,["modelValue"])]),_:1}),n(o,{label:"启用状态",prop:"enable"},{default:m(()=>[n($,{modelValue:r(l).enable,"onUpdate:modelValue":e[6]||(e[6]=a=>r(l).enable=a),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])}}},Te=G(ce,[["__scopeId","data-v-0803ab22"]]);export{Te as default};
