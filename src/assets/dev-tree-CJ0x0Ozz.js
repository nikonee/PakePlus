var B=Object.defineProperty,w=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var T=(n,a,e)=>a in n?B(n,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[a]=e,p=(n,a)=>{for(var e in a||(a={}))L.call(a,e)&&T(n,e,a[e]);if(g)for(var e of g(a))I.call(a,e)&&T(n,e,a[e]);return n},v=(n,a)=>w(n,q(a));var y=(n,a,e)=>new Promise((c,t)=>{var o=i=>{try{r(e.next(i))}catch(l){t(l)}},s=i=>{try{r(e.throw(i))}catch(l){t(l)}},r=i=>i.done?c(i.value):Promise.resolve(i.value).then(o,s);r((e=e.apply(n,a)).next())});import{A as u,u as _}from"./index-CTBb4ZkS.js";const A=_(),U=(n="device")=>y(void 0,null,function*(){try{let a=[];const{data:e}=yield u.postBaseApi("unit");if(!e)return[];a=a.concat(d(e,"unit",{parentTable:"unit",queryTable:"team"}));const{data:c}=yield u.postBaseApi("team");a=a.concat(d(c,"unit",{parentTable:"team",queryTable:"station"}));const{data:t}=yield u.postBaseApi("station");a=a.concat(d(t,"team",{parentTable:"station",queryTable:"area"}));const{data:o}=yield u.postBaseApi("area");a=a.concat(d(o,"station",{parentTable:"area",queryTable:"bay"}));const{data:s}=yield u.postBaseApi("bay");a=a.concat(d(s,"area",{parentTable:"bay",queryTable:"device"}));let r;if(n==="device"){const{data:l}=yield u.postBaseApi("device",{ordering:"order"});r=l,a=a.concat(d(l,"bay",{parentTable:"device",queryTable:"template"}))}return{success:!0,data:{treeData:h(a),firstLeaf:r.length>0?r[0]:null},message:""}}catch(a){return{success:!1,message:a}}}),x=(n="")=>y(void 0,null,function*(){try{let a=[];const e=A.stationList,c=A.stationIds;if(e.length>0&&(a=a.concat(d(e,"team",{parentTable:"station",queryTable:"area"},!0))),!c)return;const{data:t}=yield u.getBaseApi("area",{station__in:c}),o=t.map(b=>b.guid),{data:s}=yield u.getBaseApi("bay",{area__in:o.join(",")}),r=s.map(b=>b.guid);let i;const{data:l}=yield u.postBaseApi("device",{bay__in:r.join(","),ordering:"order"});i=l,a=a.concat(d(l,"bay.area.station",{parentTable:"device",queryTable:"template"}));const D=h(a);let f=null;return n?f=i.find(b=>b.guid===n):f=i.length>0?i[0]:null,{success:!0,message:"",data:{treeData:D,firstLeaf:f}}}catch(a){return{success:!1,message:a,data:{treeData:[],firstLeaf:null}}}});function d(n,a,e="0",c=!1){return n.length===0?[]:n.map(t=>{var o,s;if(t.levelType=e,c)t.parentId=a+"0";else if(a==="bay.area.station"){const r=(s=(o=t==null?void 0:t.bay)==null?void 0:o.area)==null?void 0:s.station;t.parentId=r?typeof r=="object"?a+""+r.guid:r:a+"0"}else t.parentId=t[a]?typeof t[a]=="object"?a+""+t[a].guid:t[a]:a+"0";return t.level=a,t})}function h(n){const a=[];e(n,"0",a);function e(c,t,o){c.forEach(s=>{if(s.parentId===s.level+t){const r=v(p({},s),{children:[]});o.push(r),e(c,s.guid,r.children)}})}return a}export{U as a,x as g};
