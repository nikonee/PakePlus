var D=(m,v,n)=>new Promise((c,d)=>{var a=o=>{try{s(n.next(o))}catch(l){d(l)}},i=o=>{try{s(n.throw(o))}catch(l){d(l)}},s=o=>o.done?c(o.value):Promise.resolve(o.value).then(a,i);s((n=n.apply(m,v)).next())});import{_ as k,d as g,aE as S,z as w,C as T,o as b,k as h,h as _,w as x,am as K,i as B,bx as V,j as I,t as M,aG as R,E as y}from"./index-B39jV9jF.js";import{E as L}from"./el-text-CbgfhjiV.js";import"./el-checkbox-BKHg6oYz.js";import{g as U}from"./dev-tree-qq5HqpWS.js";const j={class:"dev-tree"},z={class:"dev-tree__search"},A={class:"tree-container"},G=["title"],P={__name:"index",props:{defaultKey:{type:String,default:""},isRestrictDev:{type:Boolean,default:!0}},emits:["treeSelect"],setup(m,{expose:v,emit:n}){const c=m,d={children:"children",label:"name"},a=g(null),i=g([]),s=g(""),o=(e,t)=>e?t.name.toLowerCase().includes(e.toLowerCase()):!0;S(s,e=>{var t;(t=a.value)==null||t.filter(e)});const l=()=>{var e;(e=a.value)==null||e.filter(s.value)},E=()=>D(this,null,function*(){const e=yield U(c.defaultKey);if(e!=null&&e.success){const{treeData:t,firstLeaf:r}=e.data;i.value=t,R(()=>{var u,p;r&&((u=a.value)==null||u.setCurrentKey(r.guid),(p=a.value)==null||p.getNode(r.guid),N(r))})}else e!=null&&e.message&&y.warning(e.message)}),C=n,N=e=>{c.isRestrictDev?e!=null&&e.bay?C("treeSelect",e):(y.closeAll(),y({type:"error",message:"请选择设备",duration:1500})):C("treeSelect",e)};return v({treeExpand:e=>{const t=e==="expand";for(let r in a.value.store.nodesMap)a.value.store.nodesMap[r].expanded=t},getNode:e=>{var t;return(t=a.value)==null?void 0:t.getNode(e)},clearSearch:()=>{s.value=""},getCurrentNode:()=>{var e;return(e=a.value)==null?void 0:e.getCurrentNode()},setCurrentKey:e=>{var t;(t=a.value)==null||t.setCurrentKey(e)}}),w(()=>{E()}),(e,t)=>{const r=K,u=I,p=L;return b(),T("div",j,[h("div",z,[_(u,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=f=>s.value=f),placeholder:"请输入关键字搜索",clearable:"",onInput:l},{suffix:x(()=>[_(r,null,{default:x(()=>[_(B(V))]),_:1})]),_:1},8,["modelValue"])]),h("div",A,[_(p,{ref_key:"treeRef",ref:a,"node-key":"guid",data:i.value,props:d,"expand-on-click-node":!1,"filter-node-method":o,"default-expand-all":"","highlight-current":"",onNodeClick:N},{default:x(({node:f})=>[h("span",{class:"custom-tree-node",title:f.label},M(f.label),9,G)]),_:1},8,["data"])])])}}},$=k(P,[["__scopeId","data-v-2e7ee650"]]);export{$ as D};
